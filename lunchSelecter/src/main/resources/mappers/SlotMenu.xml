<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.korit.lunchSelect.repository.LunchSelectRepository">

	<resultMap type="com.korit.lunchSelect.entity.LunchSelect" id="LunchSelectMap">
<!-- 		<id property="id" column="restaurant_id"/> -->
<!-- 		<result property="name" column="restaurant_name"/> -->
<!-- 		<result property="address" column="restaurant_address"/> -->
<!-- 		<result property="category" column="restaurant_category"/> -->
<!-- 		<result property="lat" column="restaurant_latitude"/> -->
<!-- 		<result property="lng" column="restaurant_longtitude"/> -->
		<id property="id" column="id"/>
		<result property="name" column="name"/>
		<result property="address" column="address"/>
		<result property="category" column="category"/>
		<result property="lat" column="latitude"/>
		<result property="lng" column="ongtitude"/>
	</resultMap>
	
	<select id="findByLocation" parameterType="hashmap" resultMap="LunchSelectMap">
<!-- 		select  -->
<!-- 			*, -->
<!-- 			(6371*acos(cos(radians(#{lat}))*cos(radians(restaurant_lat))*cos(radians(restaurant_lng)-radians(#{lng}))+sin(radians(#{lat}))*sin(radians(restaurant_lat)))) AS distance -->
<!-- 		from  -->
<!-- 			restaurant_tb -->
<!-- 		having  -->
<!-- 		 	0.5 > distance  -->
		SELECT 
			*,
			(6371*acos(cos(radians(#{lat}))*cos(radians(latitude))*cos(radians(longtitude)-radians(#{lng}))+sin(radians(#{lat}))*sin(radians(latitude)))) AS distance
		FROM 
			test_tb
		HAVING 
		 	0.5 > distance 
	</select>

</mapper>